(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[285],{4282:function(e,t,r){Promise.resolve().then(r.bind(r,6799))},6799:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return w}});var a=r(7437),n=r(2265),s=r(9376),i=r(8672),o=r(6853),l=r(2869),c=r(6070),d=r(5613),u=r(5974),f=r(5302),m=r(8226),p=r(2252),x=r(5863),h=r(3050),g=r(257);let b=(0,i.J)(g.env.NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY||"pk_live_mQw9ZU3awBV35fG4HB8zPWMH");function y(e){let{planTier:t,planName:r,planPrice:s,planFeatures:i,trialDays:h,onSuccess:g,onCancel:b}=e,y=(0,o.useStripe)(),v=(0,o.useElements)(),[j,w]=(0,n.useState)(!1),[N,S]=(0,n.useState)(null),[k,_]=(0,n.useState)(!1),C=async e=>{if(e.preventDefault(),!y||!v)return;w(!0),S(null);let{error:r}=await y.confirmPayment({elements:v,confirmParams:{return_url:`${window.location.origin}/profile?tab=subscription&success=true&plan=${t}`}});r?"card_error"===r.type||"validation_error"===r.type?S(r.message):S("An unexpected error occurred."):(_(!0),g?.()),w(!1)};return k?(0,a.jsxs)(c.Zb,{className:"w-full max-w-md mx-auto",children:[(0,a.jsxs)(c.Ol,{className:"text-center",children:[(0,a.jsx)("div",{className:"mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-full bg-green-100",children:(0,a.jsx)(f.Z,{className:"h-6 w-6 text-green-600"})}),(0,a.jsx)(c.ll,{className:"text-green-900",children:"Payment Successful!"}),(0,a.jsxs)(c.SZ,{children:["Welcome to CodeFlowOps ",r,"! Your subscription is now active."]})]}),(0,a.jsx)(c.aY,{className:"text-center",children:(0,a.jsx)(l.z,{onClick:()=>window.location.href="/profile?tab=subscription",className:"w-full",children:"Go to Dashboard"})})]}):(0,a.jsxs)(c.Zb,{className:"w-full max-w-md mx-auto",children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(m.Z,{className:"h-5 w-5"}),"Complete Your Subscription"]}),(0,a.jsxs)(c.SZ,{children:["Subscribe to ",r," for ",s,"/month",h&&h>0&&(0,a.jsxs)(u.C,{children:[h," days free trial"]})]})]}),(0,a.jsxs)(c.aY,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"border rounded-lg p-4 bg-gray-50 dark:bg-gray-900",children:[(0,a.jsxs)("h4",{className:"font-semibold mb-2",children:[r," Plan"]}),(0,a.jsxs)("div",{className:"text-2xl font-bold mb-2",children:[s,(0,a.jsx)("span",{className:"text-sm font-normal",children:"/month"})]}),(0,a.jsx)("ul",{className:"space-y-1 text-sm",children:i.map((e,t)=>(0,a.jsxs)("li",{className:"flex items-center gap-2",children:[(0,a.jsx)(f.Z,{className:"h-3 w-3 text-green-500"}),e]},t))}),h&&h>0&&(0,a.jsxs)("div",{className:"mt-3 p-2 bg-blue-50 dark:bg-blue-900/20 rounded text-sm text-blue-800 dark:text-blue-200",children:[(0,a.jsx)("strong",{children:"Free Trial:"})," You won't be charged for ",h," days. Cancel anytime during the trial."]})]}),(0,a.jsxs)("form",{onSubmit:C,className:"space-y-4",children:[(0,a.jsx)(o.PaymentElement,{}),N&&(0,a.jsxs)(d.bZ,{variant:"destructive",children:[(0,a.jsx)(p.Z,{className:"h-4 w-4"}),(0,a.jsx)(d.X,{children:N})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)(l.z,{type:"button",variant:"outline",onClick:b,className:"flex-1",disabled:j,children:"Cancel"}),(0,a.jsx)(l.z,{type:"submit",disabled:j||!y||!v,className:"flex-1",children:j?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):h&&h>0?"Start Free Trial":"Subscribe Now"})]})]}),(0,a.jsx)("div",{className:"text-xs text-gray-500 text-center",children:"Secure payment powered by Stripe. Your payment information is encrypted and secure."})]})]})}function v(e){let{clientSecret:t,planTier:r,planName:s,planPrice:i,planFeatures:l,trialDays:u,onSuccess:f,onCancel:m}=e,[g,v]=(0,n.useState)(t||null),[j,w]=(0,n.useState)(!1),{createSubscription:N}=(0,h._)({onSuccess:e=>{e.client_secret&&v(e.client_secret)},onError:e=>{console.error("Failed to create subscription:",e)}});return((0,n.useEffect)(()=>{t||g||j||(w(!0),N({planTier:r,trialDays:u||0,pricingContext:{source:"checkout_page",current_plan:"free"}}).finally(()=>{w(!1)}))},[t,g,j,N,r,u]),j)?(0,a.jsx)(c.Zb,{className:"w-full max-w-2xl mx-auto",children:(0,a.jsxs)(c.aY,{className:"flex items-center justify-center p-8",children:[(0,a.jsx)(x.Z,{className:"h-6 w-6 animate-spin mr-2"}),(0,a.jsx)("span",{children:"Setting up your subscription..."})]})}):g?(0,a.jsx)(o.Elements,{options:{clientSecret:g,appearance:{theme:"stripe",variables:{colorPrimary:"#3b82f6",colorBackground:"#ffffff",colorText:"#1f2937",colorDanger:"#ef4444",fontFamily:"Inter, system-ui, sans-serif",spacingUnit:"4px",borderRadius:"8px"}}},stripe:b,children:(0,a.jsx)(y,{planTier:r,planName:s,planPrice:i,planFeatures:l,trialDays:u,onSuccess:f,onCancel:m})}):(0,a.jsx)(c.Zb,{className:"w-full max-w-2xl mx-auto",children:(0,a.jsx)(c.aY,{className:"p-8",children:(0,a.jsxs)(d.bZ,{children:[(0,a.jsx)(p.Z,{className:"h-4 w-4"}),(0,a.jsx)(d.X,{children:"Unable to initialize payment. Please try again or contact support."})]})})})}function j(){let e=(0,s.useSearchParams)(),t=e.get("client_secret"),r=e.get("plan")||"starter",n={starter:{name:"Starter",price:"$19",features:["10 projects","Private repositories","Custom domains","Email support"]},pro:{name:"Pro",price:"$49",features:["Unlimited projects","Priority support","Advanced analytics","Team collaboration"]},enterprise:{name:"Enterprise",price:"Custom",features:["Everything in Pro","Unlimited team members","White-label solution","Dedicated support"]}},i=n[r]||n.starter;return t?(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-white dark:from-gray-900 dark:to-gray-950 py-12",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,a.jsxs)("div",{className:"text-center mb-12",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold text-gray-900 dark:text-white mb-4",children:"Complete Your Subscription"}),(0,a.jsxs)("p",{className:"text-xl text-gray-600 dark:text-gray-400",children:["Subscribe to ",i.name," for ",i.price,"/month"]})]}),(0,a.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,a.jsx)(v,{planTier:r,planName:i.name,planPrice:i.price,planFeatures:i.features,trialDays:"starter"===r?14:"pro"===r?7:0,onSuccess:()=>{window.location.href="/profile?tab=subscription&success=true"},onCancel:()=>{window.location.href="/profile?tab=subscription"}})})]})}):(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-white dark:from-gray-900 dark:to-gray-950 py-12",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,a.jsxs)("div",{className:"text-center mb-12",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold text-gray-900 dark:text-white mb-4",children:"Checkout"}),(0,a.jsx)("p",{className:"text-xl text-gray-600 dark:text-gray-400",children:"No payment session found. Please return to pricing to select a plan."})]}),(0,a.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-8",children:(0,a.jsx)("div",{className:"text-center",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("a",{href:"/profile?tab=subscription",className:"inline-block bg-blue-600 text-white px-8 py-3 rounded-xl font-semibold hover:bg-blue-700 transition-colors",children:"Return to Pricing"}),(0,a.jsx)("div",{children:(0,a.jsx)("a",{href:"/contact",className:"text-blue-600 dark:text-blue-400 hover:underline",children:"Contact us for help"})})]})})})]})})}function w(){return(0,a.jsx)(n.Suspense,{fallback:(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)(x.Z,{className:"h-8 w-8 animate-spin"})}),children:(0,a.jsx)(j,{})})}},5613:function(e,t,r){"use strict";r.d(t,{X:function(){return c},bZ:function(){return l}});var a=r(7437),n=r(2265),s=r(535),i=r(4508);let o=(0,s.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),l=n.forwardRef((e,t)=>{let{className:r,variant:n,...s}=e;return(0,a.jsx)("div",{ref:t,role:"alert",className:(0,i.cn)(o({variant:n}),r),...s})});l.displayName="Alert",n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("h5",{ref:t,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",r),...n})}).displayName="AlertTitle";let c=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",r),...n})});c.displayName="AlertDescription"},5974:function(e,t,r){"use strict";r.d(t,{C:function(){return o}});var a=r(7437);r(2265);var n=r(535),s=r(4508);let i=(0,n.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:r,...n}=e;return(0,a.jsx)("div",{className:(0,s.cn)(i({variant:r}),t),...n})}},2869:function(e,t,r){"use strict";r.d(t,{z:function(){return c}});var a=r(7437),n=r(2265),s=r(7495),i=r(535),o=r(4508);let l=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=n.forwardRef((e,t)=>{let{className:r,variant:n,size:i,asChild:c=!1,...d}=e,u=c?s.g7:"button";return(0,a.jsx)(u,{className:(0,o.cn)(l({variant:n,size:i,className:r})),ref:t,...d})});c.displayName="Button"},6070:function(e,t,r){"use strict";r.d(t,{Ol:function(){return o},SZ:function(){return c},Zb:function(){return i},aY:function(){return d},eW:function(){return u},ll:function(){return l}});var a=r(7437),n=r(2265),s=r(4508);let i=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...n})});i.displayName="Card";let o=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",r),...n})});o.displayName="CardHeader";let l=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("h3",{ref:t,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",r),...n})});l.displayName="CardTitle";let c=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("p",{ref:t,className:(0,s.cn)("text-sm text-muted-foreground",r),...n})});c.displayName="CardDescription";let d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("p-6 pt-0",r),...n})});d.displayName="CardContent";let u=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("flex items-center p-6 pt-0",r),...n})});u.displayName="CardFooter"},3050:function(e,t,r){"use strict";r.d(t,{_:function(){return n}});var a=r(2265);function n(){let{onSuccess:e,onError:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[r,n]=(0,a.useState)(!1),[s,i]=(0,a.useState)(null),o="https://api.codeflowops.com",l=()=>{let e=localStorage.getItem("codeflowops_access_token");return{"Content-Type":"application/json",...e&&{Authorization:`Bearer ${e}`}}},c=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=localStorage.getItem("codeflowops_access_token");return fetch(e,{...t,credentials:"include",headers:{"Content-Type":"application/json",...r&&{Authorization:`Bearer ${r}`},...t.headers}})};return{loading:r,error:s,createSubscription:async r=>{try{n(!0),i(null);let t=await c(`${o}/api/v1/billing/subscribe/${r.planTier}`,{method:"POST",body:JSON.stringify({pricing_context:r.pricingContext||{},trial_days:r.trialDays})});if(!t.ok){let e=await t.json();throw Error(e.detail||"Failed to create subscription")}let a=await t.json();if(a.subscription.client_secret)return{...a,requires_payment:!0,client_secret:a.subscription.client_secret};return e?.(a),a}catch(r){let e=r instanceof Error?r.message:"An error occurred";throw i(e),t?.(e),r}finally{n(!1)}},upgradeSubscription:async r=>{try{n(!0),i(null);let t=await c(`${o}/api/v1/payments/upgrade-subscription`,{method:"POST",body:JSON.stringify({subscription_id:r.subscriptionId,new_plan_tier:r.newPlanTier,pricing_context:r.pricingContext||{}})});if(!t.ok){let e=await t.json();throw Error(e.detail||"Failed to upgrade subscription")}let a=await t.json();return e?.(a),a}catch(r){let e=r instanceof Error?r.message:"An error occurred";throw i(e),t?.(e),r}finally{n(!1)}},cancelSubscription:async function(r){let a=!(arguments.length>1)||void 0===arguments[1]||arguments[1];try{n(!0),i(null);let t=await fetch(`${o}/api/v1/payments/cancel-subscription`,{method:"POST",headers:l(),body:JSON.stringify({subscription_id:r,at_period_end:a})});if(!t.ok){let e=await t.json();throw Error(e.detail||"Failed to cancel subscription")}let s=await t.json();return e?.(s),s}catch(r){let e=r instanceof Error?r.message:"An error occurred";throw i(e),t?.(e),r}finally{n(!1)}},getSubscriptionStatus:async()=>{try{n(!0),i(null);let e=await fetch(`${o}/api/v1/payments/user-subscription-status`,{headers:l()});if(!e.ok){let t=await e.json();throw Error(t.detail||"Failed to get subscription status")}return await e.json()}catch(r){let e=r instanceof Error?r.message:"An error occurred";throw i(e),t?.(e),r}finally{n(!1)}},getPricingWithPaymentInfo:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{n(!0),i(null);let t=new URLSearchParams;Object.keys(e).map(t=>[t,e[t]]).forEach(e=>{let[r,a]=e;a&&t.append(r,a.toString())});let r=await fetch(`${o}/api/v1/payments/pricing-with-payment-info?${t.toString()}`,{headers:l()});if(!r.ok){let e=await r.json();throw Error(e.detail||"Failed to get pricing information")}return await r.json()}catch(r){let e=r instanceof Error?r.message:"An error occurred";throw i(e),t?.(e),r}finally{n(!1)}},getCustomerPortalUrl:async()=>{try{n(!0),i(null);let e=await fetch(`${o}/api/v1/payments/customer-portal`,{method:"POST",headers:l()});if(!e.ok){let t=await e.json();throw Error(t.detail||"Failed to get customer portal URL")}return(await e.json()).url}catch(r){let e=r instanceof Error?r.message:"An error occurred";throw i(e),t?.(e),r}finally{n(!1)}},getBillingHistory:async()=>{try{n(!0),i(null);let e=await fetch(`${o}/api/v1/payments/billing-history`,{headers:l()});if(!e.ok){let t=await e.json();throw Error(t.detail||"Failed to get billing history")}return await e.json()}catch(r){let e=r instanceof Error?r.message:"An error occurred";throw i(e),t?.(e),r}finally{n(!1)}},clearError:()=>i(null)}}},4508:function(e,t,r){"use strict";r.d(t,{cn:function(){return s}});var a=r(1994),n=r(3335);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.m6)((0,a.W)(t))}}},function(e){e.O(0,[583,712,971,117,744],function(){return e(e.s=4282)}),_N_E=e.O()}]);
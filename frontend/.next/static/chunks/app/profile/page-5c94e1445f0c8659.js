(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[178],{5236:function(e,s,t){Promise.resolve().then(t.bind(t,5617))},5617:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return K}});var a=t(7437),r=t(2265),l=t(9376),n=t(9179),i=t(8298),c=t(3050),o=t(6070),d=t(2869),m=t(5186),u=t(6815),x=t(5974),h=t(5863);function p(e){let{currentPlan:s="free"}=e,[t,l]=(0,r.useState)(null),{isAuthenticated:i,loading:m}=function(){let{user:e,isAuthenticated:s,loading:t}=(0,n.aC)();return{user:e,isAuthenticated:s,loading:t,isGuest:!t&&!s,isLoggedIn:!t&&s}}(),{createSubscription:u}=(0,c._)({onSuccess:e=>{e.checkout_url&&(window.location.href=e.checkout_url)},onError:e=>{console.error("Subscription creation failed:",e),l(null)}}),x=e=>0===e?"Free":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0}).format(e/100),p=e=>{let r=s===e.tier,n="free"===e.tier?"Get Started Free":"enterprise"===e.tier?"Contact Sales":e.trial_days&&e.trial_days>0?`Start ${e.trial_days}-Day Trial`:"Get Started";if(r)return(0,a.jsx)(d.z,{variant:"secondary",className:"w-full",disabled:!0,children:"Current Plan"});if("free"===e.tier)return(0,a.jsx)(d.z,{variant:"outline",className:"w-full",onClick:()=>window.location.href="/register?plan=free",children:n});if("enterprise"===e.tier)return(0,a.jsx)(d.z,{variant:"outline",className:"w-full",onClick:()=>window.location.href="/contact?plan=enterprise",children:n});let c=async()=>{if(!i){let s=`/register?plan=${e.tier}&trial=${e.trial_days||0}&redirect=deploy`;window.location.href=s;return}l(e.tier),await u({planTier:e.tier,trialDays:e.trial_days})};return(0,a.jsx)(d.z,{className:"w-full",onClick:c,disabled:t===e.tier||m,children:t===e.tier?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating..."]}):m?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Loading..."]}):n})};return(0,a.jsxs)("div",{className:"py-8",children:[(0,a.jsxs)("div",{className:"text-center mb-12",children:[(0,a.jsx)("h2",{className:"text-3xl font-bold mb-4",children:"Choose Your Plan"}),(0,a.jsx)("p",{className:"text-lg text-muted-foreground",children:"Scale your development workflow with our flexible pricing"})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[{tier:"free",name:"Free",price_monthly:0,description:"Perfect for personal projects",features:["3 projects","Public repositories","Basic AWS infrastructure","Standard build times","Community support"],max_projects:3,popular:!1},{tier:"starter",name:"Starter",price_monthly:1900,description:"Great for freelancers and small teams",features:["10 projects","Private repositories","Custom domains with SSL","Fast build times","Email support","API access"],max_projects:10,popular:!0,trial_days:14},{tier:"pro",name:"Pro",price_monthly:4900,description:"For professional teams with advanced needs",features:["Unlimited projects","Priority support","Advanced analytics","Team collaboration (10 members)","Deployment previews"],max_projects:-1,popular:!1,trial_days:7},{tier:"enterprise",name:"Enterprise",price_monthly:0,description:"For large teams and organizations",features:["Everything in Pro","Unlimited team members","White-label solution","Dedicated support","Custom integrations"],max_projects:-1,popular:!1}].map(e=>(0,a.jsxs)(o.Zb,{className:`relative ${e.popular?"border-primary shadow-lg scale-105":""}`,children:[e.popular&&(0,a.jsx)("div",{className:"absolute -top-3 left-1/2 transform -translate-x-1/2",children:(0,a.jsx)("span",{className:"bg-primary text-primary-foreground px-3 py-1 rounded-full text-sm font-medium",children:"Most Popular"})}),(0,a.jsxs)(o.Ol,{className:"text-center",children:[(0,a.jsx)(o.ll,{className:"text-xl mb-2",children:e.name}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("span",{className:"text-4xl font-bold",children:x(e.price_monthly)}),e.price_monthly>0&&(0,a.jsx)("span",{className:"text-muted-foreground",children:"/month"})]}),(0,a.jsx)(o.SZ,{children:e.description})]}),(0,a.jsxs)(o.aY,{className:"space-y-4",children:[(0,a.jsx)("ul",{className:"space-y-2 mb-6",children:e.features.map((e,s)=>(0,a.jsxs)("li",{className:"flex items-center text-sm",children:[(0,a.jsx)("span",{className:"mr-2 text-primary",children:"âœ“"}),e]},s))}),p(e),e.trial_days&&e.trial_days>0&&(0,a.jsxs)("p",{className:"text-xs text-center text-muted-foreground",children:[e.trial_days,"-day free trial â€¢ Cancel anytime"]})]})]},e.tier))}),(0,a.jsx)("div",{className:"mt-12 text-center",children:(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["All plans include our core deployment features.",(0,a.jsx)("br",{}),"Need something custom? ",(0,a.jsx)("a",{href:"/contact",className:"text-primary hover:underline",children:"Contact us"})]})})]})}var f=t(6110),j=t(8226),g=t(5252),y=t(1047),N=t(2208),v=t(2735);function w(e){let{onFetchBillingHistory:s,children:t}=e,[l,n]=(0,r.useState)(!1),[i,c]=(0,r.useState)([]),[m,u]=(0,r.useState)(!1),[p,w]=(0,r.useState)(null),b=async()=>{n(!0),u(!0),w(null);try{let e=await s();c(e)}catch(e){w("Failed to load billing history"),console.error("Error fetching billing history:",e)}finally{u(!1)}},k=(e,s)=>new Intl.NumberFormat("en-US",{style:"currency",currency:s.toUpperCase()}).format(e/100),_=e=>new Date(1e3*e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),Z=e=>{let s={paid:{variant:"default",label:"Paid"},open:{variant:"secondary",label:"Open"},void:{variant:"destructive",label:"Void"},draft:{variant:"outline",label:"Draft"}}[e]||{variant:"outline",label:e};return(0,a.jsx)(x.C,{variant:s.variant,children:s.label})};return(0,a.jsxs)(f.Vq,{open:l,onOpenChange:n,children:[(0,a.jsx)(f.hg,{asChild:!0,onClick:b,children:t}),(0,a.jsxs)(f.cZ,{className:"max-w-4xl max-h-[80vh] overflow-hidden",children:[(0,a.jsxs)(f.fK,{children:[(0,a.jsxs)(f.$N,{className:"flex items-center gap-2",children:[(0,a.jsx)(j.Z,{className:"h-5 w-5"}),"Billing History"]}),(0,a.jsx)(f.Be,{children:"View and download your past invoices and payment history"})]}),(0,a.jsx)("div",{className:"flex-1 overflow-auto",children:m?(0,a.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,a.jsx)(h.Z,{className:"h-6 w-6 animate-spin mr-2"}),(0,a.jsx)("span",{children:"Loading billing history..."})]}):p?(0,a.jsxs)("div",{className:"text-center py-8 text-red-600",children:[(0,a.jsx)("p",{children:p}),(0,a.jsx)(d.z,{variant:"outline",onClick:b,className:"mt-4",children:"Try Again"})]}):0===i.length?(0,a.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,a.jsx)(j.Z,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,a.jsx)("p",{children:"No billing history found"}),(0,a.jsx)("p",{className:"text-sm",children:"Your invoices will appear here after your first payment"})]}):(0,a.jsx)("div",{className:"space-y-4",children:i.map(e=>(0,a.jsx)(o.Zb,{className:"hover:shadow-md transition-shadow",children:(0,a.jsx)(o.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsx)("h3",{className:"font-medium",children:e.number||`Invoice ${e.id.slice(-8)}`}),Z(e.status)]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm text-muted-foreground",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(g.Z,{className:"h-3 w-3"}),(0,a.jsx)("span",{children:k(e.amount_paid,e.currency)})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(y.Z,{className:"h-3 w-3"}),(0,a.jsx)("span",{children:_(e.created)})]})]}),e.description&&(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:e.description}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground mt-1",children:["Period: ",_(e.period_start)," - ",_(e.period_end)]})]}),(0,a.jsxs)("div",{className:"flex gap-2 ml-4",children:[e.hosted_invoice_url&&(0,a.jsxs)(d.z,{variant:"outline",size:"sm",onClick:()=>window.open(e.hosted_invoice_url,"_blank"),children:[(0,a.jsx)(N.Z,{className:"h-3 w-3 mr-1"}),"View"]}),e.invoice_pdf&&(0,a.jsxs)(d.z,{variant:"outline",size:"sm",onClick:()=>window.open(e.invoice_pdf,"_blank"),children:[(0,a.jsx)(v.Z,{className:"h-3 w-3 mr-1"}),"PDF"]})]})]})})},e.id))})})]})]})}var b=t(2759),k=t(5613),_=t(4401),Z=t(3639),C=t(5302),S=t(1723),P=t(1239),D=t(525);function z(e){let{onUpgrade:s}=e,[t,l]=(0,r.useState)(null),[n,i]=(0,r.useState)(!0),[c,m]=(0,r.useState)(null);(0,r.useEffect)(()=>{u()},[]);let u=async()=>{try{i(!0);let e=await fetch("http://localhost:8000/api/quota/status",{credentials:"include"});if(e.ok){let s=await e.json();l(s.quota)}else m("Failed to load quota information")}catch(e){console.error("Quota fetch error:",e),m("Failed to load quota information")}finally{i(!1)}},h=e=>e>=90?"text-red-600":e>=70?"text-yellow-600":"text-green-600";return n?(0,a.jsxs)(o.Zb,{children:[(0,a.jsx)(o.Ol,{children:(0,a.jsxs)(o.ll,{className:"flex items-center space-x-2",children:[(0,a.jsx)(_.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"Usage & Limits"})]})}),(0,a.jsx)(o.aY,{children:(0,a.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),(0,a.jsx)("div",{className:"h-2 bg-gray-200 rounded"}),(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})})]}):c||!t?(0,a.jsxs)(o.Zb,{children:[(0,a.jsx)(o.Ol,{children:(0,a.jsxs)(o.ll,{className:"flex items-center space-x-2",children:[(0,a.jsx)(_.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"Usage & Limits"})]})}),(0,a.jsx)(o.aY,{children:(0,a.jsxs)(k.bZ,{variant:"destructive",children:[(0,a.jsx)(Z.Z,{className:"h-4 w-4"}),(0,a.jsx)(k.X,{children:c||"Failed to load quota information"})]})})]}):(0,a.jsxs)(o.Zb,{children:[(0,a.jsxs)(o.Ol,{children:[(0,a.jsxs)(o.ll,{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(_.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"Usage & Limits"})]}),(0,a.jsx)(x.C,{variant:"outline",className:"capitalize",children:t.plan.name})]}),(0,a.jsx)(o.SZ,{children:"Track your deployment usage and plan limits"})]}),(0,a.jsxs)(o.aY,{className:"space-y-6",children:[t.deployment_allowed.can_deploy?t.monthly_runs.percentage>=80?(0,a.jsxs)(k.bZ,{variant:"destructive",children:[(0,a.jsx)(Z.Z,{className:"h-4 w-4"}),(0,a.jsx)(k.X,{children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{children:(0,a.jsx)("strong",{children:"âš ï¸ Quota Warning!"})}),(0,a.jsxs)("div",{className:"text-sm",children:["You've used ",t.monthly_runs.percentage.toFixed(0),"% of your monthly deployments. Consider upgrading to avoid service interruption."]}),(0,a.jsx)(d.z,{size:"sm",variant:"outline",className:"mt-2 w-full",onClick:s,children:"View Upgrade Options"})]})})]}):(0,a.jsxs)(k.bZ,{children:[(0,a.jsx)(C.Z,{className:"h-4 w-4"}),(0,a.jsxs)(k.X,{children:[(0,a.jsx)("strong",{children:"âœ… Ready to deploy!"})," All quota limits are within acceptable range."]})]}):(0,a.jsxs)(k.bZ,{variant:"destructive",children:[(0,a.jsx)(Z.Z,{className:"h-4 w-4"}),(0,a.jsx)(k.X,{children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{children:(0,a.jsx)("strong",{children:"âš ï¸ Deployments Blocked!"})}),(0,a.jsx)("div",{className:"text-sm",children:t.deployment_allowed.monthly_check.passed?`âš¡ ${t.deployment_allowed.concurrent_check.reason}`:`ðŸ“… ${t.deployment_allowed.monthly_check.reason}`}),!t.deployment_allowed.monthly_check.passed&&(0,a.jsx)(d.z,{size:"sm",className:"mt-2 w-full",onClick:s,children:"\uD83D\uDE80 Upgrade for More Deployments"})]})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(S.Z,{className:"h-4 w-4 text-blue-600"}),(0,a.jsx)("span",{className:"font-medium",children:"Monthly Deployments"})]}),(0,a.jsx)("span",{className:`text-sm font-medium ${h(t.monthly_runs.percentage)}`,children:t.monthly_runs.unlimited?`${t.monthly_runs.used} used`:`${t.monthly_runs.used} / ${t.monthly_runs.limit}`})]}),!t.monthly_runs.unlimited&&(0,a.jsx)(b.E,{value:t.monthly_runs.percentage,className:"h-2"}),(0,a.jsxs)("div",{className:"flex justify-between text-xs text-gray-600",children:[(0,a.jsx)("span",{children:t.monthly_runs.unlimited?"Unlimited deployments":`${t.monthly_runs.remaining} remaining this month`}),!t.monthly_runs.unlimited&&(0,a.jsxs)("span",{className:h(t.monthly_runs.percentage),children:[t.monthly_runs.percentage.toFixed(1),"%"]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(P.Z,{className:"h-4 w-4 text-purple-600"}),(0,a.jsx)("span",{className:"font-medium",children:"Concurrent Deployments"})]}),(0,a.jsxs)("span",{className:`text-sm font-medium ${h(t.concurrent_runs.percentage)}`,children:[t.concurrent_runs.active," / ",t.concurrent_runs.limit]})]}),(0,a.jsx)(b.E,{value:t.concurrent_runs.percentage,className:"h-2"}),(0,a.jsxs)("div",{className:"flex justify-between text-xs text-gray-600",children:[(0,a.jsxs)("span",{children:[t.concurrent_runs.remaining," slots available"]}),(0,a.jsxs)("span",{className:h(t.concurrent_runs.percentage),children:[t.concurrent_runs.percentage.toFixed(1),"%"]})]})]}),(0,a.jsx)("div",{className:"pt-4 border-t space-y-3",children:t.upgrade_suggestion?(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(D.Z,{className:"h-4 w-4 text-blue-600"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"\uD83D\uDCA1 Recommendation"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:t.upgrade_suggestion}),(0,a.jsx)(d.z,{size:"sm",onClick:s,className:"w-full",children:"\uD83D\uDE80 Upgrade Now"})]}):"free"===t.plan.tier&&t.monthly_runs.percentage>=50?(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(D.Z,{className:"h-4 w-4 text-blue-600"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"\uD83D\uDCA1 Growing Fast?"})]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["You're already at ",t.monthly_runs.percentage.toFixed(0),"% usage. Starter plan gives you 50 deployments/month + 14-day free trial!"]}),(0,a.jsx)(d.z,{size:"sm",onClick:s,className:"w-full",children:"\uD83C\uDFAF Try Starter Free for 14 Days"})]}):"starter"===t.plan.tier&&t.monthly_runs.percentage>=60?(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(D.Z,{className:"h-4 w-4 text-blue-600"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"\uD83D\uDE80 Power User?"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Pro plan offers 200 deployments/month + 5 concurrent deployments for teams."}),(0,a.jsx)(d.z,{size:"sm",onClick:s,className:"w-full",children:"âš¡ Upgrade to Pro"})]}):(0,a.jsx)("div",{className:"text-center py-2",children:(0,a.jsx)(d.z,{size:"sm",variant:"outline",onClick:s,className:"w-full",children:"\uD83D\uDCCA View All Plans"})})})]})]})}var F=t(2339),A=t(6831),E=t(5131),U=t(8906),$=t(3581),Y=t(2489),R=t(9202),O=t(5621),T=t(8930),I=t(5135),V=t(2369),L=t(7689),q=t(4630),B=t(3229),G=t(9345),H=t(8728),M=t(7168),Q=t(5929),X=t(7226);function W(){let e=(0,l.useSearchParams)(),{user:s,isAuthenticated:t,fetchUserProfile:i,updateUserProfile:f,fetchUserDeployments:g,clearDeploymentHistory:N,profilePicture:v,updateProfilePicture:b,removeProfilePicture:_}=(0,n.aC)(),{createSubscription:Z,cancelSubscription:P,loading:D}=(0,c._)({onSuccess:e=>{e.client_secret?window.location.href=`/checkout?client_secret=${e.client_secret}`:window.location.reload()},onError:e=>{alert(`Payment operation failed: ${e}`)}}),[Q,X]=(0,r.useState)(!0),[W,K]=(0,r.useState)(!1),[ee,es]=(0,r.useState)([]),[et,ea]=(0,r.useState)(null),[er,el]=(0,r.useState)({full_name:s?.full_name||"",email:s?.email||""}),[en,ei]=(0,r.useState)(!1),[ec,eo]=(0,r.useState)("overview"),ed=async()=>{try{await Z({planTier:"pro",trialDays:14,pricingContext:{source:"profile_upgrade",current_plan:et?.plan}})}catch(e){console.error("Upgrade failed:",e)}},em=async()=>{try{let e=localStorage.getItem("codeflowops_access_token"),s=await fetch("https://api.codeflowops.com/api/v1/payments/customer-portal",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(s.ok){let{url:e}=await s.json();window.location.href=e}else alert("Unable to access payment management. Please try again.")}catch(e){console.error("Payment method management failed:",e),alert("Unable to access payment management. Please try again.")}},eu=async()=>{let e=localStorage.getItem("codeflowops_access_token"),s=await fetch("https://api.codeflowops.com/api/v1/payments/billing-history",{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!s.ok)throw Error("Failed to fetch billing history");return(await s.json()).invoices||[]},ex=async()=>{if(!et?.plan||"free"===et.plan){alert("No active subscription to cancel.");return}if(confirm("Are you sure you want to cancel your subscription? You will lose access to premium features at the end of your billing period."))try{let e=localStorage.getItem("codeflowops_access_token"),s=await fetch("https://api.codeflowops.com/api/v1/payments/cancel-subscription",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({subscription_id:et.id||"current",at_period_end:!0})});if(s.ok)alert("Subscription cancelled successfully. You will retain access until the end of your billing period."),window.location.reload();else{let e=await s.json();alert(`Failed to cancel subscription: ${e.detail||"Unknown error"}`)}}catch(e){console.error("Subscription cancellation failed:",e),alert("Failed to cancel subscription. Please contact support.")}};(0,r.useEffect)(()=>{let e=async()=>{if(t)try{X(!0);let e=await i();if(e.user&&el({full_name:e.user.full_name||"",email:e.user.email||""}),e.subscription){let s=e.subscription,t={plan:s.plan?.tier||"free",status:s.status||"active",currentPeriodEnd:s.current_period_end||s.trial_end||null,deployments:{used:s.usage?.projects_count||0,limit:s.plan?.max_projects||5}};ea(t)}let s=await g();s?.deployments&&es(s.deployments)}catch(e){console.error("Error fetching user data:",e),es([]),et||ea({plan:"free",status:"active",currentPeriodEnd:null,deployments:{used:0,limit:5}})}finally{X(!1)}};t&&e()},[t,i,g]),(0,r.useEffect)(()=>{let s=e.get("tab");s&&["overview","deployments","subscription","settings"].includes(s)&&eo(s)},[e]);let eh=async()=>{try{X(!0),await f(er),K(!1)}catch(e){console.error("Error updating profile:",e)}finally{X(!1)}},ep=e=>{switch(e){case"success":return(0,a.jsx)(C.Z,{className:"h-4 w-4 text-green-500"});case"failed":return(0,a.jsx)(E.Z,{className:"h-4 w-4 text-red-500"});case"building":case"pending":return(0,a.jsx)(S.Z,{className:"h-4 w-4 text-yellow-500"});default:return(0,a.jsx)(S.Z,{className:"h-4 w-4 text-gray-500"})}},ef=e=>(0,a.jsx)(x.C,{children:e.charAt(0).toUpperCase()+e.slice(1)}),ej=e=>(0,a.jsx)(x.C,{children:e.toUpperCase()}),eg=()=>{let e=new Date;return e.setDate(e.getDate()-7),ee.filter(s=>{let t=s.createdAt||s.created_at;return!!t&&new Date(t)>=e})},ey=async()=>{try{X(!0),await N();try{let e=await g();e?.deployments?es(e.deployments):es([])}catch(e){console.warn("Failed to refetch deployments after clear, setting to empty:",e),es([])}console.log("Deployment history cleared successfully")}catch(e){console.error("Error clearing deployment history:",e),console.warn("Failed to clear deployment history")}finally{X(!1)}},eN=async e=>{let s=e.target.files?.[0];if(s)try{ei(!0),await b(s),console.log("Profile picture uploaded successfully")}catch(e){console.error("Error uploading profile picture:",e),alert(e instanceof Error?e.message:"Failed to upload profile picture. Please try again.")}finally{ei(!1)}},ev=()=>{_(),console.log("Profile picture removed successfully")};if(!t)return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)(o.Zb,{className:"w-full max-w-md",children:(0,a.jsx)(o.aY,{className:"pt-6",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(U.Z,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),(0,a.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Authentication Required"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:"Please sign in to view your profile."}),(0,a.jsx)(d.z,{asChild:!0,children:(0,a.jsx)("a",{href:"/login",children:"Sign In"})})]})})})});let ew=s?.full_name?s.full_name.split(" ").map(e=>e[0]).join("").toUpperCase():s?.email?.charAt(0).toUpperCase()||"U";return(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-8",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,a.jsx)("div",{className:"mb-8",children:(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"relative group",children:[(0,a.jsxs)(A.qE,{className:"h-16 w-16",children:[v?(0,a.jsx)(A.F$,{src:v,alt:"Profile picture",className:"avatar-image"}):null,(0,a.jsx)(A.Q5,{className:"bg-primary text-primary-foreground text-lg",children:ew})]}),(0,a.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-50 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-200 flex items-center justify-center",children:(0,a.jsxs)("label",{htmlFor:"profile-picture-upload",className:"cursor-pointer",children:[(0,a.jsx)($.Z,{className:"h-6 w-6 text-white"}),(0,a.jsx)("input",{id:"profile-picture-upload",type:"file",accept:"image/*",onChange:eN,className:"hidden",disabled:en})]})}),en&&(0,a.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-50 rounded-full flex items-center justify-center",children:(0,a.jsx)(h.Z,{className:"h-6 w-6 text-white animate-spin"})})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:s?.full_name||"User Profile"}),v&&(0,a.jsxs)(d.z,{variant:"ghost",size:"sm",onClick:ev,className:"text-red-600 hover:text-red-700 hover:bg-red-50 dark:text-red-400 dark:hover:text-red-300 dark:hover:bg-red-950",children:[(0,a.jsx)(Y.Z,{className:"h-4 w-4 mr-1"}),"Remove Photo"]})]}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:s?.email}),(0,a.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-1",children:"Hover over avatar to change profile picture"})]})]})}),(0,a.jsxs)(F.mQ,{value:ec,onValueChange:eo,className:"space-y-6",children:[(0,a.jsxs)(F.dr,{className:"grid w-full grid-cols-5",children:[(0,a.jsx)(F.SP,{value:"overview",children:"Overview"}),(0,a.jsx)(F.SP,{value:"deployments",children:"Deployments"}),(0,a.jsx)(F.SP,{value:"subscription",children:"Subscription"}),(0,a.jsx)(F.SP,{value:"settings",children:"Settings"}),(0,a.jsx)(F.SP,{value:"debug",children:"Debug"})]}),(0,a.jsxs)(F.nU,{value:"overview",className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsx)(o.Zb,{children:(0,a.jsx)(o.aY,{className:"pt-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Deployments"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:ee.length})]}),(0,a.jsx)(R.Z,{className:"h-8 w-8 text-muted-foreground"})]})})}),(0,a.jsx)(o.Zb,{children:(0,a.jsx)(o.aY,{className:"pt-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Successful Deployments"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:ee.filter(e=>"success"===e.status).length})]}),(0,a.jsx)(C.Z,{className:"h-8 w-8 text-green-500"})]})})}),(0,a.jsx)(o.Zb,{children:(0,a.jsx)(o.aY,{className:"pt-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Current Plan"}),(0,a.jsxs)("p",{className:"text-xl font-bold flex items-center gap-2",children:[et?.plan.toUpperCase(),ej(et?.plan||"trial")]})]}),(0,a.jsx)(j.Z,{className:"h-8 w-8 text-muted-foreground"})]})})})]}),(0,a.jsxs)(o.Zb,{children:[(0,a.jsxs)(o.Ol,{children:[(0,a.jsxs)(o.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(O.Z,{className:"h-5 w-5"}),"Recent Deployments"]}),(0,a.jsx)(o.SZ,{children:"Your latest deployment activity"})]}),(0,a.jsx)(o.aY,{children:Q?(0,a.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,a.jsx)(h.Z,{className:"h-8 w-8 animate-spin"})}):0===ee.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(R.Z,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"No deployments yet"})]}):(0,a.jsx)("div",{className:"space-y-4",children:ee.slice(0,3).map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[ep(e.status),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:e.repository})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(x.C,{children:e.technology}),ef(e.status),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:new Date(e.createdAt||e.created_at||"").toLocaleDateString()})]})]},e.id))})})]})]}),(0,a.jsx)(F.nU,{value:"deployments",className:"space-y-6",children:(0,a.jsxs)(o.Zb,{children:[(0,a.jsxs)(o.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(o.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(R.Z,{className:"h-5 w-5"}),"Recent Deployments"]}),(0,a.jsx)(o.SZ,{children:"Deployment history from the last 7 days"})]}),(0,a.jsxs)(d.z,{variant:"outline",size:"sm",onClick:ey,disabled:Q||0===eg().length,className:"text-red-600 hover:text-red-700 hover:bg-red-50 dark:text-red-400 dark:hover:text-red-300 dark:hover:bg-red-950",children:[(0,a.jsx)(T.Z,{className:"h-4 w-4 mr-2"}),"Clear History"]})]}),(0,a.jsxs)(o.aY,{children:[(0,a.jsxs)(k.bZ,{className:"mb-4 bg-blue-50 border-blue-200",children:[(0,a.jsx)(O.Z,{className:"h-4 w-4"}),(0,a.jsxs)(k.X,{className:"text-blue-700",children:[(0,a.jsx)("strong",{children:"Note:"})," Deployment history is automatically deleted after 7 days for security and storage optimization."]})]}),Q?(0,a.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,a.jsx)(h.Z,{className:"h-8 w-8 animate-spin"})}):0===eg().length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(O.Z,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),(0,a.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No Recent Deployments"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"You haven't deployed anything in the last 7 days."})]}):(0,a.jsx)("div",{className:"space-y-4",children:eg().map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[ep(e.status),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:e.name}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-muted-foreground",children:[(0,a.jsx)(I.Z,{className:"h-3 w-3"}),(0,a.jsx)("span",{children:e.repository})]}),e.url&&(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-blue-600",children:[(0,a.jsx)(R.Z,{className:"h-3 w-3"}),(0,a.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:e.url})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(x.C,{children:e.technology}),ef(e.status),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:new Date(e.createdAt||e.created_at||"").toLocaleDateString()}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:new Date(e.createdAt||e.created_at||"").toLocaleTimeString()})]})]})]},e.id))})]})]})}),(0,a.jsxs)(F.nU,{value:"subscription",className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)(o.Zb,{children:[(0,a.jsx)(o.Ol,{children:(0,a.jsxs)(o.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(j.Z,{className:"h-5 w-5"}),"Current Plan"]})}),(0,a.jsx)(o.aY,{className:"space-y-4",children:et&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"font-medium",children:"Plan:"}),ej(et.plan)]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"font-medium",children:"Status:"}),(0,a.jsx)(x.C,{children:et.status.toUpperCase()})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"font-medium",children:"Deployments:"}),(0,a.jsxs)("span",{children:[et.deployments.used," / ",et.deployments.limit]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${et.deployments.used/et.deployments.limit*100}%`}})}),"trial"===et.plan&&(0,a.jsxs)(k.bZ,{children:[(0,a.jsx)(y.Z,{className:"h-4 w-4"}),(0,a.jsxs)(k.X,{children:["Your trial expires on ",et.currentPeriodEnd?new Date(et.currentPeriodEnd).toLocaleDateString():"N/A"]})]})]})})]}),(0,a.jsx)(z,{onUpgrade:()=>{eo("billing"),setTimeout(()=>{let e=document.querySelector("[data-pricing-section]");e&&e.scrollIntoView({behavior:"smooth"})},100)}}),(0,a.jsxs)(o.Zb,{children:[(0,a.jsx)(o.Ol,{children:(0,a.jsx)(o.ll,{children:"Plan Management"})}),(0,a.jsx)(o.aY,{className:"space-y-4",children:et?.plan==="trial"?(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Upgrade your plan to unlock more features and deployments."}),(0,a.jsx)(d.z,{className:"w-full text-white dark:text-white",onClick:ed,disabled:D,children:D?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Processing..."]}):"Upgrade to Pro"}),(0,a.jsx)(d.z,{variant:"outline",className:"w-full dark:text-white dark:border-gray-600 dark:hover:bg-gray-700",onClick:()=>eo("subscription"),children:"View All Plans"})]}):(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Manage your subscription and billing."}),(0,a.jsx)(d.z,{variant:"outline",className:"w-full dark:text-white dark:border-gray-600 dark:hover:bg-gray-700",onClick:em,disabled:D,children:D?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Loading..."]}):"Update Payment Method"}),(0,a.jsx)(w,{onFetchBillingHistory:eu,children:(0,a.jsx)(d.z,{variant:"outline",className:"w-full dark:text-white dark:border-gray-600 dark:hover:bg-gray-700",disabled:D,children:D?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Loading..."]}):"View Billing History"})}),(0,a.jsx)(d.z,{variant:"destructive",className:"w-full text-white dark:text-white",onClick:ex,disabled:D,children:D?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Processing..."]}):"Cancel Subscription"})]})})]})]}),(0,a.jsxs)(o.Zb,{"data-pricing-section":!0,children:[(0,a.jsxs)(o.Ol,{children:[(0,a.jsx)(o.ll,{children:"Available Plans"}),(0,a.jsx)(o.SZ,{children:"Choose the plan that best fits your needs"})]}),(0,a.jsx)(o.aY,{children:(0,a.jsx)(p,{currentPlan:et?.plan})})]})]}),(0,a.jsx)(F.nU,{value:"settings",className:"space-y-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)(o.Zb,{children:[(0,a.jsxs)(o.Ol,{children:[(0,a.jsxs)(o.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(V.Z,{className:"h-5 w-5"}),"Profile Information"]}),(0,a.jsx)(o.SZ,{children:"Update your personal information"})]}),(0,a.jsxs)(o.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(u._,{children:"Profile Picture"}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)(A.qE,{className:"h-12 w-12",children:[v?(0,a.jsx)(A.F$,{src:v,alt:"Profile picture",className:"avatar-image"}):null,(0,a.jsx)(A.Q5,{className:"bg-primary text-primary-foreground",children:ew})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("label",{htmlFor:"settings-profile-picture-upload",children:[(0,a.jsx)(d.z,{variant:"outline",size:"sm",asChild:!0,disabled:en,className:"dark:text-white dark:border-gray-600 dark:hover:bg-gray-700",children:(0,a.jsxs)("div",{className:"cursor-pointer",children:[en?(0,a.jsx)(h.Z,{className:"h-4 w-4 mr-2 animate-spin"}):(0,a.jsx)(L.Z,{className:"h-4 w-4 mr-2"}),"Upload"]})}),(0,a.jsx)("input",{id:"settings-profile-picture-upload",type:"file",accept:"image/*",onChange:eN,className:"hidden",disabled:en})]}),v&&(0,a.jsxs)(d.z,{variant:"outline",size:"sm",onClick:ev,className:"text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300",children:[(0,a.jsx)(T.Z,{className:"h-4 w-4 mr-2"}),"Remove"]})]})]}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"JPG, PNG or GIF (max. 5MB)"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(u._,{htmlFor:"fullName",children:"Full Name"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(m.I,{id:"fullName",value:er.full_name,onChange:e=>el(s=>({...s,full_name:e.target.value})),disabled:!W}),!W&&(0,a.jsx)(d.z,{variant:"outline",size:"icon",onClick:()=>K(!0),className:"dark:text-white dark:border-gray-600 dark:hover:bg-gray-700",children:(0,a.jsx)(q.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(u._,{htmlFor:"email",children:"Email Address"}),(0,a.jsx)(m.I,{id:"email",type:"email",value:er.email,disabled:!0,className:"bg-gray-50 dark:bg-gray-800 dark:text-white dark:border-gray-600"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Email address cannot be changed. Contact support if needed."})]}),W&&(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(d.z,{onClick:eh,disabled:Q,className:"text-white dark:text-white",children:Q?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(B.Z,{className:"mr-2 h-4 w-4"}),"Save Changes"]})}),(0,a.jsxs)(d.z,{variant:"outline",onClick:()=>K(!1),className:"dark:text-white dark:border-gray-600 dark:hover:bg-gray-700",children:[(0,a.jsx)(Y.Z,{className:"mr-2 h-4 w-4"}),"Cancel"]})]})]})]}),(0,a.jsxs)(o.Zb,{children:[(0,a.jsxs)(o.Ol,{children:[(0,a.jsxs)(o.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(U.Z,{className:"h-5 w-5"}),"Security"]}),(0,a.jsx)(o.SZ,{children:"Manage your account security"})]}),(0,a.jsx)(o.aY,{className:"space-y-4",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(d.z,{variant:"outline",className:"w-full justify-start dark:text-white dark:border-gray-600 dark:hover:bg-gray-700",children:"Change Password"}),(0,a.jsx)(d.z,{variant:"outline",className:"w-full justify-start dark:text-white dark:border-gray-600 dark:hover:bg-gray-700",children:"Two-Factor Authentication"}),(0,a.jsx)(d.z,{variant:"outline",className:"w-full justify-start dark:text-white dark:border-gray-600 dark:hover:bg-gray-700",children:"Connected Accounts"})]})})]}),(0,a.jsxs)(o.Zb,{children:[(0,a.jsxs)(o.Ol,{children:[(0,a.jsxs)(o.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(G.Z,{className:"h-5 w-5"}),"Notifications"]}),(0,a.jsx)(o.SZ,{children:"Configure your notification preferences"})]}),(0,a.jsx)(o.aY,{className:"space-y-4",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"Deployment Updates"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Get notified when deployments complete"})]}),(0,a.jsx)("input",{type:"checkbox",defaultChecked:!0,className:"rounded"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"Weekly Reports"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Receive weekly deployment summaries"})]}),(0,a.jsx)("input",{type:"checkbox",defaultChecked:!0,className:"rounded"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"Security Alerts"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Important security notifications"})]}),(0,a.jsx)("input",{type:"checkbox",defaultChecked:!0,className:"rounded"})]})]})})]}),(0,a.jsxs)(o.Zb,{children:[(0,a.jsxs)(o.Ol,{children:[(0,a.jsxs)(o.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(H.Z,{className:"h-5 w-5"}),"Theme"]}),(0,a.jsx)(o.SZ,{children:"Choose your preferred color scheme"})]}),(0,a.jsx)(o.aY,{className:"space-y-4",children:(0,a.jsx)(J,{})})]}),(0,a.jsxs)(o.Zb,{className:"border-red-200",children:[(0,a.jsxs)(o.Ol,{children:[(0,a.jsxs)(o.ll,{className:"flex items-center gap-2 text-red-600",children:[(0,a.jsx)(E.Z,{className:"h-5 w-5"}),"Danger Zone"]}),(0,a.jsx)(o.SZ,{children:"Irreversible actions that affect your account"})]}),(0,a.jsxs)(o.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(d.z,{variant:"outline",className:"w-full justify-start border-red-200 text-red-600 hover:bg-red-50 dark:border-red-800 dark:text-red-400 dark:hover:bg-red-950 dark:hover:text-red-300",children:"Download Account Data"}),(0,a.jsx)(d.z,{variant:"destructive",className:"w-full justify-start text-white dark:text-white",children:"Delete Account"})]}),(0,a.jsxs)(k.bZ,{className:"border-red-200",children:[(0,a.jsx)(E.Z,{className:"h-4 w-4"}),(0,a.jsx)(k.X,{className:"text-red-600",children:"Account deletion is permanent and cannot be undone."})]})]})]})]})}),(0,a.jsx)(F.nU,{value:"debug",className:"space-y-6",children:(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)(o.Zb,{children:[(0,a.jsxs)(o.Ol,{children:[(0,a.jsxs)(o.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(H.Z,{className:"h-5 w-5"}),"Authentication Debug"]}),(0,a.jsx)(o.SZ,{children:"Debug information for troubleshooting authentication and API issues"})]}),(0,a.jsxs)(o.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(u._,{children:"Authentication Status"}),(0,a.jsxs)("div",{className:"text-sm bg-muted p-3 rounded",children:[(0,a.jsxs)("div",{children:["Authenticated: ",t?"âœ… Yes":"âŒ No"]}),(0,a.jsxs)("div",{children:["Provider: ",s?.provider||"None"]}),(0,a.jsxs)("div",{children:["User ID: ",s?.id||"None"]}),(0,a.jsxs)("div",{children:["Username: ",s?.username||"None"]}),(0,a.jsxs)("div",{children:["Email: ",s?.email||"None"]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(u._,{children:"API Endpoints Test"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(d.z,{variant:"outline",size:"sm",onClick:async()=>{try{let e=await fetch("https://api.codeflowops.com/api/v1/auth/github/user",{credentials:"include"});console.log("GitHub User API:",e.status,await e.text())}catch(e){console.error("API Test Error:",e)}},children:"Test GitHub User API"}),(0,a.jsx)(d.z,{variant:"outline",size:"sm",onClick:async()=>{try{let e=await fetch("https://api.codeflowops.com/api/quota/status",{credentials:"include"});console.log("Quota API:",e.status,await e.text())}catch(e){console.error("API Test Error:",e)}},children:"Test Quota API"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(u._,{children:"GitHub OAuth Login"}),(0,a.jsxs)(d.z,{onClick:()=>{window.location.href="https://api.codeflowops.com/api/v1/auth/github"},className:"w-full",children:[(0,a.jsx)(I.Z,{className:"mr-2 h-4 w-4"}),"Login with GitHub OAuth"]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(u._,{children:"Manual Profile Refresh"}),(0,a.jsxs)(d.z,{variant:"outline",onClick:i,className:"w-full",children:[(0,a.jsx)(M.Z,{className:"mr-2 h-4 w-4"}),"Refresh User Profile"]})]})]})]})})})]})]})})}function J(){let{theme:e,setTheme:s,resolvedTheme:t}=(0,i.F)(),r=[{name:"Light",value:"light",icon:Q.Z},{name:"Dark",value:"dark",icon:X.Z},{name:"System",value:"system",icon:H.Z}];return(0,a.jsx)("div",{className:"space-y-3",children:r.map(r=>{let l=r.icon,n=e===r.value;return(0,a.jsxs)(d.z,{variant:n?"default":"outline",className:`w-full justify-start ${n?"text-white dark:text-white":"dark:text-white dark:border-gray-600 dark:hover:bg-gray-700"}`,onClick:()=>s(r.value),children:[(0,a.jsx)(l,{className:"h-4 w-4 mr-2"}),r.name,"system"===r.value&&t&&(0,a.jsxs)("span",{className:"ml-auto text-xs text-muted-foreground",children:["(",t,")"]})]},r.value)})})}function K(){return(0,a.jsx)(r.Suspense,{fallback:(0,a.jsx)("div",{children:"Loading..."}),children:(0,a.jsx)(W,{})})}},5613:function(e,s,t){"use strict";t.d(s,{X:function(){return o},bZ:function(){return c}});var a=t(7437),r=t(2265),l=t(535),n=t(4508);let i=(0,l.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),c=r.forwardRef((e,s)=>{let{className:t,variant:r,...l}=e;return(0,a.jsx)("div",{ref:s,role:"alert",className:(0,n.cn)(i({variant:r}),t),...l})});c.displayName="Alert",r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("h5",{ref:s,className:(0,n.cn)("mb-1 font-medium leading-none tracking-tight",t),...r})}).displayName="AlertTitle";let o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,n.cn)("text-sm [&_p]:leading-relaxed",t),...r})});o.displayName="AlertDescription"},6831:function(e,s,t){"use strict";t.d(s,{F$:function(){return c},Q5:function(){return o},qE:function(){return i}});var a=t(7437),r=t(2265),l=t(1146),n=t(4508);let i=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.fC,{ref:s,className:(0,n.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...r})});i.displayName=l.fC.displayName;let c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.Ee,{ref:s,className:(0,n.cn)("aspect-square h-full w-full",t),...r})});c.displayName=l.Ee.displayName;let o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.NY,{ref:s,className:(0,n.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...r})});o.displayName=l.NY.displayName},5974:function(e,s,t){"use strict";t.d(s,{C:function(){return i}});var a=t(7437);t(2265);var r=t(535),l=t(4508);let n=(0,r.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:s,variant:t,...r}=e;return(0,a.jsx)("div",{className:(0,l.cn)(n({variant:t}),s),...r})}},6070:function(e,s,t){"use strict";t.d(s,{Ol:function(){return i},SZ:function(){return o},Zb:function(){return n},aY:function(){return d},eW:function(){return m},ll:function(){return c}});var a=t(7437),r=t(2265),l=t(4508);let n=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...r})});n.displayName="Card";let i=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",t),...r})});i.displayName="CardHeader";let c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("h3",{ref:s,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",t),...r})});c.displayName="CardTitle";let o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("p",{ref:s,className:(0,l.cn)("text-sm text-muted-foreground",t),...r})});o.displayName="CardDescription";let d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("p-6 pt-0",t),...r})});d.displayName="CardContent";let m=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("flex items-center p-6 pt-0",t),...r})});m.displayName="CardFooter"},6110:function(e,s,t){"use strict";t.d(s,{$N:function(){return p},Be:function(){return f},Vq:function(){return c},cN:function(){return h},cZ:function(){return u},fK:function(){return x},hg:function(){return o}});var a=t(7437),r=t(2265),l=t(9027),n=t(2489),i=t(4508);let c=l.fC,o=l.xz,d=l.h_;l.x8;let m=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.aV,{ref:s,className:(0,i.cn)("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r})});m.displayName=l.aV.displayName;let u=r.forwardRef((e,s)=>{let{className:t,children:r,...c}=e;return(0,a.jsxs)(d,{children:[(0,a.jsx)(m,{}),(0,a.jsxs)(l.VY,{ref:s,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...c,children:[r,(0,a.jsxs)(l.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(n.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});u.displayName=l.VY.displayName;let x=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",s),...t})};x.displayName="DialogHeader";let h=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t})};h.displayName="DialogFooter";let p=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.Dx,{ref:s,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",t),...r})});p.displayName=l.Dx.displayName;let f=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.dk,{ref:s,className:(0,i.cn)("text-sm text-muted-foreground",t),...r})});f.displayName=l.dk.displayName},5186:function(e,s,t){"use strict";t.d(s,{I:function(){return n}});var a=t(7437),r=t(2265),l=t(4508);let n=r.forwardRef((e,s)=>{let{className:t,type:r,...n}=e;return(0,a.jsx)("input",{type:r,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...n})});n.displayName="Input"},6815:function(e,s,t){"use strict";t.d(s,{_:function(){return o}});var a=t(7437),r=t(2265),l=t(6394),n=t(535),i=t(4508);let c=(0,n.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.f,{ref:s,className:(0,i.cn)(c(),t),...r})});o.displayName=l.f.displayName},2759:function(e,s,t){"use strict";t.d(s,{E:function(){return n}});var a=t(7437),r=t(2265),l=t(4508);let n=r.forwardRef((e,s)=>{let{className:t,value:r,...n}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...n,children:(0,a.jsx)("div",{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(r||0)}%)`}})})});n.displayName="Progress"},2339:function(e,s,t){"use strict";t.d(s,{SP:function(){return o},dr:function(){return c},mQ:function(){return i},nU:function(){return d}});var a=t(7437),r=t(2265),l=t(271),n=t(4508);let i=l.fC,c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.aV,{ref:s,className:(0,n.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...r})});c.displayName=l.aV.displayName;let o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.xz,{ref:s,className:(0,n.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...r})});o.displayName=l.xz.displayName;let d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.VY,{ref:s,className:(0,n.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...r})});d.displayName=l.VY.displayName},3050:function(e,s,t){"use strict";t.d(s,{_:function(){return r}});var a=t(2265);function r(){let{onSuccess:e,onError:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,r]=(0,a.useState)(!1),[l,n]=(0,a.useState)(null),i="https://api.codeflowops.com",c=()=>{let e=localStorage.getItem("codeflowops_access_token");return{"Content-Type":"application/json",...e&&{Authorization:`Bearer ${e}`}}},o=async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=localStorage.getItem("codeflowops_access_token");return fetch(e,{...s,credentials:"include",headers:{"Content-Type":"application/json",...t&&{Authorization:`Bearer ${t}`},...s.headers}})};return{loading:t,error:l,createSubscription:async t=>{try{r(!0),n(null);let s=await o(`${i}/api/v1/billing/subscribe/${t.planTier}`,{method:"POST",body:JSON.stringify({pricing_context:t.pricingContext||{},trial_days:t.trialDays})});if(!s.ok){let e=await s.json();throw Error(e.detail||"Failed to create subscription")}let a=await s.json();if(a.subscription.client_secret)return{...a,requires_payment:!0,client_secret:a.subscription.client_secret};return e?.(a),a}catch(t){let e=t instanceof Error?t.message:"An error occurred";throw n(e),s?.(e),t}finally{r(!1)}},upgradeSubscription:async t=>{try{r(!0),n(null);let s=await o(`${i}/api/v1/payments/upgrade-subscription`,{method:"POST",body:JSON.stringify({subscription_id:t.subscriptionId,new_plan_tier:t.newPlanTier,pricing_context:t.pricingContext||{}})});if(!s.ok){let e=await s.json();throw Error(e.detail||"Failed to upgrade subscription")}let a=await s.json();return e?.(a),a}catch(t){let e=t instanceof Error?t.message:"An error occurred";throw n(e),s?.(e),t}finally{r(!1)}},cancelSubscription:async function(t){let a=!(arguments.length>1)||void 0===arguments[1]||arguments[1];try{r(!0),n(null);let s=await fetch(`${i}/api/v1/payments/cancel-subscription`,{method:"POST",headers:c(),body:JSON.stringify({subscription_id:t,at_period_end:a})});if(!s.ok){let e=await s.json();throw Error(e.detail||"Failed to cancel subscription")}let l=await s.json();return e?.(l),l}catch(t){let e=t instanceof Error?t.message:"An error occurred";throw n(e),s?.(e),t}finally{r(!1)}},getSubscriptionStatus:async()=>{try{r(!0),n(null);let e=await fetch(`${i}/api/v1/payments/user-subscription-status`,{headers:c()});if(!e.ok){let s=await e.json();throw Error(s.detail||"Failed to get subscription status")}return await e.json()}catch(t){let e=t instanceof Error?t.message:"An error occurred";throw n(e),s?.(e),t}finally{r(!1)}},getPricingWithPaymentInfo:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{r(!0),n(null);let s=new URLSearchParams;Object.keys(e).map(s=>[s,e[s]]).forEach(e=>{let[t,a]=e;a&&s.append(t,a.toString())});let t=await fetch(`${i}/api/v1/payments/pricing-with-payment-info?${s.toString()}`,{headers:c()});if(!t.ok){let e=await t.json();throw Error(e.detail||"Failed to get pricing information")}return await t.json()}catch(t){let e=t instanceof Error?t.message:"An error occurred";throw n(e),s?.(e),t}finally{r(!1)}},getCustomerPortalUrl:async()=>{try{r(!0),n(null);let e=await fetch(`${i}/api/v1/payments/customer-portal`,{method:"POST",headers:c()});if(!e.ok){let s=await e.json();throw Error(s.detail||"Failed to get customer portal URL")}return(await e.json()).url}catch(t){let e=t instanceof Error?t.message:"An error occurred";throw n(e),s?.(e),t}finally{r(!1)}},getBillingHistory:async()=>{try{r(!0),n(null);let e=await fetch(`${i}/api/v1/payments/billing-history`,{headers:c()});if(!e.ok){let s=await e.json();throw Error(s.detail||"Failed to get billing history")}return await e.json()}catch(t){let e=t instanceof Error?t.message:"An error occurred";throw n(e),s?.(e),t}finally{r(!1)}},clearError:()=>n(null)}}}},function(e){e.O(0,[583,343,752,80,619,971,117,744],function(){return e(e.s=5236)}),_N_E=e.O()}]);